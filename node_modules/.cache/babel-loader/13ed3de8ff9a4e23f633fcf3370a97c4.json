{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"prefixCls\", \"className\", \"style\", \"prefix\", \"split\", \"notFoundContent\", \"value\", \"defaultValue\", \"children\", \"options\", \"open\", \"allowClear\", \"silent\", \"validateSearch\", \"filterOption\", \"onChange\", \"onKeyDown\", \"onKeyUp\", \"onPressEnter\", \"onSearch\", \"onSelect\", \"onFocus\", \"onBlur\", \"transitionName\", \"placement\", \"direction\", \"getPopupContainer\", \"dropdownClassName\", \"rows\", \"visible\", \"onPopupScroll\"],\n    _excluded2 = [\"suffix\", \"prefixCls\", \"defaultValue\", \"value\", \"allowClear\", \"onChange\", \"classNames\", \"className\", \"disabled\", \"onClear\"];\nimport classNames from 'classnames';\nimport { BaseInput } from 'rc-input';\nimport TextArea from 'rc-textarea';\nimport toArray from \"rc-util/es/Children/toArray\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport warning from \"rc-util/es/warning\";\nimport React, { forwardRef, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport useEffectState from \"./hooks/useEffectState\";\nimport KeywordTrigger from \"./KeywordTrigger\";\nimport MentionsContext from \"./MentionsContext\";\nimport Option from \"./Option\";\nimport { filterOption as defaultFilterOption, validateSearch as defaultValidateSearch, getBeforeSelectionText, getLastMeasureIndex, replaceWithMeasure, setInputSelection } from \"./util\";\nvar InternalMentions = /*#__PURE__*/forwardRef(function (props, ref) {\n  var prefixCls = props.prefixCls,\n      className = props.className,\n      style = props.style,\n      _props$prefix = props.prefix,\n      prefix = _props$prefix === void 0 ? '@' : _props$prefix,\n      _props$split = props.split,\n      split = _props$split === void 0 ? ' ' : _props$split,\n      _props$notFoundConten = props.notFoundContent,\n      notFoundContent = _props$notFoundConten === void 0 ? 'Not Found' : _props$notFoundConten,\n      value = props.value,\n      defaultValue = props.defaultValue,\n      children = props.children,\n      options = props.options,\n      open = props.open,\n      allowClear = props.allowClear,\n      silent = props.silent,\n      _props$validateSearch = props.validateSearch,\n      validateSearch = _props$validateSearch === void 0 ? defaultValidateSearch : _props$validateSearch,\n      _props$filterOption = props.filterOption,\n      filterOption = _props$filterOption === void 0 ? defaultFilterOption : _props$filterOption,\n      onChange = props.onChange,\n      onKeyDown = props.onKeyDown,\n      onKeyUp = props.onKeyUp,\n      onPressEnter = props.onPressEnter,\n      onSearch = props.onSearch,\n      onSelect = props.onSelect,\n      onFocus = props.onFocus,\n      onBlur = props.onBlur,\n      transitionName = props.transitionName,\n      placement = props.placement,\n      direction = props.direction,\n      getPopupContainer = props.getPopupContainer,\n      dropdownClassName = props.dropdownClassName,\n      _props$rows = props.rows,\n      rows = _props$rows === void 0 ? 1 : _props$rows,\n      visible = props.visible,\n      onPopupScroll = props.onPopupScroll,\n      restProps = _objectWithoutProperties(props, _excluded);\n\n  var mergedPrefix = useMemo(function () {\n    return Array.isArray(prefix) ? prefix : [prefix];\n  }, [prefix]); // =============================== Refs ===============================\n\n  var containerRef = useRef(null);\n  var textareaRef = useRef(null);\n  var measureRef = useRef(null);\n\n  var getTextArea = function getTextArea() {\n    var _textareaRef$current;\n\n    return (_textareaRef$current = textareaRef.current) === null || _textareaRef$current === void 0 || (_textareaRef$current = _textareaRef$current.resizableTextArea) === null || _textareaRef$current === void 0 ? void 0 : _textareaRef$current.textArea;\n  };\n\n  React.useImperativeHandle(ref, function () {\n    var _textareaRef$current4;\n\n    return {\n      focus: function focus() {\n        var _textareaRef$current2;\n\n        return (_textareaRef$current2 = textareaRef.current) === null || _textareaRef$current2 === void 0 ? void 0 : _textareaRef$current2.focus();\n      },\n      blur: function blur() {\n        var _textareaRef$current3;\n\n        return (_textareaRef$current3 = textareaRef.current) === null || _textareaRef$current3 === void 0 ? void 0 : _textareaRef$current3.blur();\n      },\n      textarea: (_textareaRef$current4 = textareaRef.current) === null || _textareaRef$current4 === void 0 || (_textareaRef$current4 = _textareaRef$current4.resizableTextArea) === null || _textareaRef$current4 === void 0 ? void 0 : _textareaRef$current4.textArea,\n      nativeElement: containerRef.current\n    };\n  }); // ============================== State ===============================\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      measuring = _useState2[0],\n      setMeasuring = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      measureText = _useState4[0],\n      setMeasureText = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      measurePrefix = _useState6[0],\n      setMeasurePrefix = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      measureLocation = _useState8[0],\n      setMeasureLocation = _useState8[1];\n\n  var _useState9 = useState(0),\n      _useState10 = _slicedToArray(_useState9, 2),\n      activeIndex = _useState10[0],\n      setActiveIndex = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      isFocus = _useState12[0],\n      setIsFocus = _useState12[1]; // ============================== Value ===============================\n\n\n  var _useMergedState = useMergedState('', {\n    defaultValue: defaultValue,\n    value: value\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      mergedValue = _useMergedState2[0],\n      setMergedValue = _useMergedState2[1]; // =============================== Open ===============================\n\n\n  useEffect(function () {\n    // Sync measure div top with textarea for rc-trigger usage\n    if (measuring && measureRef.current) {\n      measureRef.current.scrollTop = getTextArea().scrollTop;\n    }\n  }, [measuring]);\n\n  var _React$useMemo = React.useMemo(function () {\n    if (open) {\n      if (process.env.NODE_ENV !== 'production') {\n        warning(false, '`open` of Mentions is only used for debug usage. Do not use in you production.');\n      }\n\n      for (var i = 0; i < mergedPrefix.length; i += 1) {\n        var curPrefix = mergedPrefix[i];\n        var index = mergedValue.lastIndexOf(curPrefix);\n\n        if (index >= 0) {\n          return [true, '', curPrefix, index];\n        }\n      }\n    }\n\n    return [measuring, measureText, measurePrefix, measureLocation];\n  }, [open, measuring, mergedPrefix, mergedValue, measureText, measurePrefix, measureLocation]),\n      _React$useMemo2 = _slicedToArray(_React$useMemo, 4),\n      mergedMeasuring = _React$useMemo2[0],\n      mergedMeasureText = _React$useMemo2[1],\n      mergedMeasurePrefix = _React$useMemo2[2],\n      mergedMeasureLocation = _React$useMemo2[3]; // ============================== Option ==============================\n\n\n  var getOptions = React.useCallback(function (targetMeasureText) {\n    var list;\n\n    if (options && options.length > 0) {\n      list = options.map(function (item) {\n        var _item$key;\n\n        return _objectSpread(_objectSpread({}, item), {}, {\n          key: (_item$key = item === null || item === void 0 ? void 0 : item.key) !== null && _item$key !== void 0 ? _item$key : item.value\n        });\n      });\n    } else {\n      list = toArray(children).map(function (_ref) {\n        var optionProps = _ref.props,\n            key = _ref.key;\n        return _objectSpread(_objectSpread({}, optionProps), {}, {\n          label: optionProps.children,\n          key: key || optionProps.value\n        });\n      });\n    }\n\n    return list.filter(function (option) {\n      /** Return all result if `filterOption` is false. */\n      if (filterOption === false) {\n        return true;\n      }\n\n      return filterOption(targetMeasureText, option);\n    });\n  }, [children, options, filterOption]);\n  var mergedOptions = React.useMemo(function () {\n    return getOptions(mergedMeasureText);\n  }, [getOptions, mergedMeasureText]); // ============================= Measure ==============================\n  // Mark that we will reset input selection to target position when user select option\n\n  var onSelectionEffect = useEffectState();\n\n  var startMeasure = function startMeasure(nextMeasureText, nextMeasurePrefix, nextMeasureLocation) {\n    setMeasuring(true);\n    setMeasureText(nextMeasureText);\n    setMeasurePrefix(nextMeasurePrefix);\n    setMeasureLocation(nextMeasureLocation);\n    setActiveIndex(0);\n  };\n\n  var stopMeasure = function stopMeasure(callback) {\n    setMeasuring(false);\n    setMeasureLocation(0);\n    setMeasureText('');\n    onSelectionEffect(callback);\n  }; // ============================== Change ==============================\n\n\n  var triggerChange = function triggerChange(nextValue) {\n    setMergedValue(nextValue);\n    onChange === null || onChange === void 0 || onChange(nextValue);\n  };\n\n  var onInternalChange = function onInternalChange(_ref2) {\n    var nextValue = _ref2.target.value;\n    triggerChange(nextValue);\n  };\n\n  var selectOption = function selectOption(option) {\n    var _getTextArea;\n\n    var _option$value = option.value,\n        mentionValue = _option$value === void 0 ? '' : _option$value;\n\n    var _replaceWithMeasure = replaceWithMeasure(mergedValue, {\n      measureLocation: mergedMeasureLocation,\n      targetText: mentionValue,\n      prefix: mergedMeasurePrefix,\n      selectionStart: (_getTextArea = getTextArea()) === null || _getTextArea === void 0 ? void 0 : _getTextArea.selectionStart,\n      split: split\n    }),\n        text = _replaceWithMeasure.text,\n        selectionLocation = _replaceWithMeasure.selectionLocation;\n\n    triggerChange(text);\n    stopMeasure(function () {\n      // We need restore the selection position\n      setInputSelection(getTextArea(), selectionLocation);\n    });\n    onSelect === null || onSelect === void 0 || onSelect(option, mergedMeasurePrefix);\n  }; // ============================= KeyEvent =============================\n  // Check if hit the measure keyword\n\n\n  var onInternalKeyDown = function onInternalKeyDown(event) {\n    var which = event.which;\n    onKeyDown === null || onKeyDown === void 0 || onKeyDown(event); // Skip if not measuring\n\n    if (!mergedMeasuring) {\n      return;\n    }\n\n    if (which === KeyCode.UP || which === KeyCode.DOWN) {\n      // Control arrow function\n      var optionLen = mergedOptions.length;\n      var offset = which === KeyCode.UP ? -1 : 1;\n      var newActiveIndex = (activeIndex + offset + optionLen) % optionLen;\n      setActiveIndex(newActiveIndex);\n      event.preventDefault();\n    } else if (which === KeyCode.ESC) {\n      stopMeasure();\n    } else if (which === KeyCode.ENTER) {\n      // Measure hit\n      event.preventDefault(); // loading skip\n\n      if (silent) {\n        return;\n      }\n\n      if (!mergedOptions.length) {\n        stopMeasure();\n        return;\n      }\n\n      var _option = mergedOptions[activeIndex];\n      selectOption(_option);\n    }\n  };\n  /**\n   * When to start measure:\n   * 1. When user press `prefix`\n   * 2. When measureText !== prevMeasureText\n   *  - If measure hit\n   *  - If measuring\n   *\n   * When to stop measure:\n   * 1. Selection is out of range\n   * 2. Contains `space`\n   * 3. ESC or select one\n   */\n\n\n  var onInternalKeyUp = function onInternalKeyUp(event) {\n    var key = event.key,\n        which = event.which;\n    var target = event.target;\n    var selectionStartText = getBeforeSelectionText(target);\n\n    var _getLastMeasureIndex = getLastMeasureIndex(selectionStartText, mergedPrefix),\n        measureIndex = _getLastMeasureIndex.location,\n        nextMeasurePrefix = _getLastMeasureIndex.prefix; // If the client implements an onKeyUp handler, call it\n\n\n    onKeyUp === null || onKeyUp === void 0 || onKeyUp(event); // Skip if match the white key list\n\n    if ([KeyCode.ESC, KeyCode.UP, KeyCode.DOWN, KeyCode.ENTER].indexOf(which) !== -1) {\n      return;\n    }\n\n    if (measureIndex !== -1) {\n      var nextMeasureText = selectionStartText.slice(measureIndex + nextMeasurePrefix.length);\n      var validateMeasure = validateSearch(nextMeasureText, split);\n      var matchOption = !!getOptions(nextMeasureText).length;\n\n      if (validateMeasure) {\n        // adding AltGraph also fort azert keyboard\n        if (key === nextMeasurePrefix || key === 'Shift' || which === KeyCode.ALT || key === 'AltGraph' || mergedMeasuring || nextMeasureText !== mergedMeasureText && matchOption) {\n          startMeasure(nextMeasureText, nextMeasurePrefix, measureIndex);\n        }\n      } else if (mergedMeasuring) {\n        // Stop if measureText is invalidate\n        stopMeasure();\n      }\n      /**\n       * We will trigger `onSearch` to developer since they may use for async update.\n       * If met `space` means user finished searching.\n       */\n\n\n      if (onSearch && validateMeasure) {\n        onSearch(nextMeasureText, nextMeasurePrefix);\n      }\n    } else if (mergedMeasuring) {\n      stopMeasure();\n    }\n  };\n\n  var onInternalPressEnter = function onInternalPressEnter(event) {\n    if (!mergedMeasuring && onPressEnter) {\n      onPressEnter(event);\n    }\n  }; // ============================ Focus Blur ============================\n\n\n  var focusRef = useRef();\n\n  var onInternalFocus = function onInternalFocus(event) {\n    window.clearTimeout(focusRef.current);\n\n    if (!isFocus && event && onFocus) {\n      onFocus(event);\n    }\n\n    setIsFocus(true);\n  };\n\n  var onInternalBlur = function onInternalBlur(event) {\n    focusRef.current = window.setTimeout(function () {\n      setIsFocus(false);\n      stopMeasure();\n      onBlur === null || onBlur === void 0 || onBlur(event);\n    }, 0);\n  };\n\n  var onDropdownFocus = function onDropdownFocus() {\n    onInternalFocus();\n  };\n\n  var onDropdownBlur = function onDropdownBlur() {\n    onInternalBlur();\n  }; // ============================== Scroll ===============================\n\n\n  var onInternalPopupScroll = function onInternalPopupScroll(event) {\n    onPopupScroll === null || onPopupScroll === void 0 || onPopupScroll(event);\n  }; // ============================== Render ==============================\n\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(prefixCls, className),\n    style: style,\n    ref: containerRef\n  }, /*#__PURE__*/React.createElement(TextArea, _extends({\n    ref: textareaRef,\n    value: mergedValue\n  }, restProps, {\n    rows: rows,\n    onChange: onInternalChange,\n    onKeyDown: onInternalKeyDown,\n    onKeyUp: onInternalKeyUp,\n    onPressEnter: onInternalPressEnter,\n    onFocus: onInternalFocus,\n    onBlur: onInternalBlur\n  })), mergedMeasuring && /*#__PURE__*/React.createElement(\"div\", {\n    ref: measureRef,\n    className: \"\".concat(prefixCls, \"-measure\")\n  }, mergedValue.slice(0, mergedMeasureLocation), /*#__PURE__*/React.createElement(MentionsContext.Provider, {\n    value: {\n      notFoundContent: notFoundContent,\n      activeIndex: activeIndex,\n      setActiveIndex: setActiveIndex,\n      selectOption: selectOption,\n      onFocus: onDropdownFocus,\n      onBlur: onDropdownBlur,\n      onScroll: onInternalPopupScroll\n    }\n  }, /*#__PURE__*/React.createElement(KeywordTrigger, {\n    prefixCls: prefixCls,\n    transitionName: transitionName,\n    placement: placement,\n    direction: direction,\n    options: mergedOptions,\n    visible: true,\n    getPopupContainer: getPopupContainer,\n    dropdownClassName: dropdownClassName\n  }, /*#__PURE__*/React.createElement(\"span\", null, mergedMeasurePrefix))), mergedValue.slice(mergedMeasureLocation + mergedMeasurePrefix.length)));\n});\nvar Mentions = /*#__PURE__*/forwardRef(function (_ref3, ref) {\n  var suffix = _ref3.suffix,\n      _ref3$prefixCls = _ref3.prefixCls,\n      prefixCls = _ref3$prefixCls === void 0 ? 'rc-mentions' : _ref3$prefixCls,\n      defaultValue = _ref3.defaultValue,\n      customValue = _ref3.value,\n      allowClear = _ref3.allowClear,\n      onChange = _ref3.onChange,\n      classes = _ref3.classNames,\n      className = _ref3.className,\n      disabled = _ref3.disabled,\n      onClear = _ref3.onClear,\n      rest = _objectWithoutProperties(_ref3, _excluded2); // =============================== Ref ================================\n\n\n  var holderRef = useRef(null);\n  var mentionRef = useRef(null);\n  useImperativeHandle(ref, function () {\n    var _holderRef$current, _mentionRef$current;\n\n    return _objectSpread(_objectSpread({}, mentionRef.current), {}, {\n      nativeElement: ((_holderRef$current = holderRef.current) === null || _holderRef$current === void 0 ? void 0 : _holderRef$current.nativeElement) || ((_mentionRef$current = mentionRef.current) === null || _mentionRef$current === void 0 ? void 0 : _mentionRef$current.nativeElement)\n    });\n  }); // ============================== Value ===============================\n\n  var _useMergedState3 = useMergedState('', {\n    defaultValue: defaultValue,\n    value: customValue\n  }),\n      _useMergedState4 = _slicedToArray(_useMergedState3, 2),\n      mergedValue = _useMergedState4[0],\n      setMergedValue = _useMergedState4[1]; // ============================== Change ==============================\n\n\n  var triggerChange = function triggerChange(currentValue) {\n    setMergedValue(currentValue);\n    onChange === null || onChange === void 0 || onChange(currentValue);\n  }; // ============================== Reset ===============================\n\n\n  var handleReset = function handleReset() {\n    triggerChange('');\n  };\n\n  return /*#__PURE__*/React.createElement(BaseInput, {\n    suffix: suffix,\n    prefixCls: prefixCls,\n    value: mergedValue,\n    allowClear: allowClear,\n    handleReset: handleReset,\n    className: className,\n    classNames: classes,\n    disabled: disabled,\n    ref: holderRef,\n    onClear: onClear\n  }, /*#__PURE__*/React.createElement(InternalMentions, _extends({\n    className: classes === null || classes === void 0 ? void 0 : classes.mentions,\n    prefixCls: prefixCls,\n    ref: mentionRef,\n    onChange: triggerChange,\n    disabled: disabled\n  }, rest)));\n});\nMentions.Option = Option;\nexport default Mentions;","map":{"version":3,"sources":["/Users/malith_bandara/Desktop/AdminDashboard/node_modules/rc-mentions/es/Mentions.js"],"names":["_extends","_objectSpread","_slicedToArray","_objectWithoutProperties","_excluded","_excluded2","classNames","BaseInput","TextArea","toArray","useMergedState","KeyCode","warning","React","forwardRef","useEffect","useImperativeHandle","useMemo","useRef","useState","useEffectState","KeywordTrigger","MentionsContext","Option","filterOption","defaultFilterOption","validateSearch","defaultValidateSearch","getBeforeSelectionText","getLastMeasureIndex","replaceWithMeasure","setInputSelection","InternalMentions","props","ref","prefixCls","className","style","_props$prefix","prefix","_props$split","split","_props$notFoundConten","notFoundContent","value","defaultValue","children","options","open","allowClear","silent","_props$validateSearch","_props$filterOption","onChange","onKeyDown","onKeyUp","onPressEnter","onSearch","onSelect","onFocus","onBlur","transitionName","placement","direction","getPopupContainer","dropdownClassName","_props$rows","rows","visible","onPopupScroll","restProps","mergedPrefix","Array","isArray","containerRef","textareaRef","measureRef","getTextArea","_textareaRef$current","current","resizableTextArea","textArea","_textareaRef$current4","focus","_textareaRef$current2","blur","_textareaRef$current3","textarea","nativeElement","_useState","_useState2","measuring","setMeasuring","_useState3","_useState4","measureText","setMeasureText","_useState5","_useState6","measurePrefix","setMeasurePrefix","_useState7","_useState8","measureLocation","setMeasureLocation","_useState9","_useState10","activeIndex","setActiveIndex","_useState11","_useState12","isFocus","setIsFocus","_useMergedState","_useMergedState2","mergedValue","setMergedValue","scrollTop","_React$useMemo","process","env","NODE_ENV","i","length","curPrefix","index","lastIndexOf","_React$useMemo2","mergedMeasuring","mergedMeasureText","mergedMeasurePrefix","mergedMeasureLocation","getOptions","useCallback","targetMeasureText","list","map","item","_item$key","key","_ref","optionProps","label","filter","option","mergedOptions","onSelectionEffect","startMeasure","nextMeasureText","nextMeasurePrefix","nextMeasureLocation","stopMeasure","callback","triggerChange","nextValue","onInternalChange","_ref2","target","selectOption","_getTextArea","_option$value","mentionValue","_replaceWithMeasure","targetText","selectionStart","text","selectionLocation","onInternalKeyDown","event","which","UP","DOWN","optionLen","offset","newActiveIndex","preventDefault","ESC","ENTER","_option","onInternalKeyUp","selectionStartText","_getLastMeasureIndex","measureIndex","location","indexOf","slice","validateMeasure","matchOption","ALT","onInternalPressEnter","focusRef","onInternalFocus","window","clearTimeout","onInternalBlur","setTimeout","onDropdownFocus","onDropdownBlur","onInternalPopupScroll","createElement","concat","Provider","onScroll","Mentions","_ref3","suffix","_ref3$prefixCls","customValue","classes","disabled","onClear","rest","holderRef","mentionRef","_holderRef$current","_mentionRef$current","_useMergedState3","_useMergedState4","currentValue","handleReset","mentions"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"prefixCls\", \"className\", \"style\", \"prefix\", \"split\", \"notFoundContent\", \"value\", \"defaultValue\", \"children\", \"options\", \"open\", \"allowClear\", \"silent\", \"validateSearch\", \"filterOption\", \"onChange\", \"onKeyDown\", \"onKeyUp\", \"onPressEnter\", \"onSearch\", \"onSelect\", \"onFocus\", \"onBlur\", \"transitionName\", \"placement\", \"direction\", \"getPopupContainer\", \"dropdownClassName\", \"rows\", \"visible\", \"onPopupScroll\"],\n  _excluded2 = [\"suffix\", \"prefixCls\", \"defaultValue\", \"value\", \"allowClear\", \"onChange\", \"classNames\", \"className\", \"disabled\", \"onClear\"];\nimport classNames from 'classnames';\nimport { BaseInput } from 'rc-input';\nimport TextArea from 'rc-textarea';\nimport toArray from \"rc-util/es/Children/toArray\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport warning from \"rc-util/es/warning\";\nimport React, { forwardRef, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport useEffectState from \"./hooks/useEffectState\";\nimport KeywordTrigger from \"./KeywordTrigger\";\nimport MentionsContext from \"./MentionsContext\";\nimport Option from \"./Option\";\nimport { filterOption as defaultFilterOption, validateSearch as defaultValidateSearch, getBeforeSelectionText, getLastMeasureIndex, replaceWithMeasure, setInputSelection } from \"./util\";\nvar InternalMentions = /*#__PURE__*/forwardRef(function (props, ref) {\n  var prefixCls = props.prefixCls,\n    className = props.className,\n    style = props.style,\n    _props$prefix = props.prefix,\n    prefix = _props$prefix === void 0 ? '@' : _props$prefix,\n    _props$split = props.split,\n    split = _props$split === void 0 ? ' ' : _props$split,\n    _props$notFoundConten = props.notFoundContent,\n    notFoundContent = _props$notFoundConten === void 0 ? 'Not Found' : _props$notFoundConten,\n    value = props.value,\n    defaultValue = props.defaultValue,\n    children = props.children,\n    options = props.options,\n    open = props.open,\n    allowClear = props.allowClear,\n    silent = props.silent,\n    _props$validateSearch = props.validateSearch,\n    validateSearch = _props$validateSearch === void 0 ? defaultValidateSearch : _props$validateSearch,\n    _props$filterOption = props.filterOption,\n    filterOption = _props$filterOption === void 0 ? defaultFilterOption : _props$filterOption,\n    onChange = props.onChange,\n    onKeyDown = props.onKeyDown,\n    onKeyUp = props.onKeyUp,\n    onPressEnter = props.onPressEnter,\n    onSearch = props.onSearch,\n    onSelect = props.onSelect,\n    onFocus = props.onFocus,\n    onBlur = props.onBlur,\n    transitionName = props.transitionName,\n    placement = props.placement,\n    direction = props.direction,\n    getPopupContainer = props.getPopupContainer,\n    dropdownClassName = props.dropdownClassName,\n    _props$rows = props.rows,\n    rows = _props$rows === void 0 ? 1 : _props$rows,\n    visible = props.visible,\n    onPopupScroll = props.onPopupScroll,\n    restProps = _objectWithoutProperties(props, _excluded);\n  var mergedPrefix = useMemo(function () {\n    return Array.isArray(prefix) ? prefix : [prefix];\n  }, [prefix]);\n\n  // =============================== Refs ===============================\n  var containerRef = useRef(null);\n  var textareaRef = useRef(null);\n  var measureRef = useRef(null);\n  var getTextArea = function getTextArea() {\n    var _textareaRef$current;\n    return (_textareaRef$current = textareaRef.current) === null || _textareaRef$current === void 0 || (_textareaRef$current = _textareaRef$current.resizableTextArea) === null || _textareaRef$current === void 0 ? void 0 : _textareaRef$current.textArea;\n  };\n  React.useImperativeHandle(ref, function () {\n    var _textareaRef$current4;\n    return {\n      focus: function focus() {\n        var _textareaRef$current2;\n        return (_textareaRef$current2 = textareaRef.current) === null || _textareaRef$current2 === void 0 ? void 0 : _textareaRef$current2.focus();\n      },\n      blur: function blur() {\n        var _textareaRef$current3;\n        return (_textareaRef$current3 = textareaRef.current) === null || _textareaRef$current3 === void 0 ? void 0 : _textareaRef$current3.blur();\n      },\n      textarea: (_textareaRef$current4 = textareaRef.current) === null || _textareaRef$current4 === void 0 || (_textareaRef$current4 = _textareaRef$current4.resizableTextArea) === null || _textareaRef$current4 === void 0 ? void 0 : _textareaRef$current4.textArea,\n      nativeElement: containerRef.current\n    };\n  });\n\n  // ============================== State ===============================\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    measuring = _useState2[0],\n    setMeasuring = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    measureText = _useState4[0],\n    setMeasureText = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    measurePrefix = _useState6[0],\n    setMeasurePrefix = _useState6[1];\n  var _useState7 = useState(0),\n    _useState8 = _slicedToArray(_useState7, 2),\n    measureLocation = _useState8[0],\n    setMeasureLocation = _useState8[1];\n  var _useState9 = useState(0),\n    _useState10 = _slicedToArray(_useState9, 2),\n    activeIndex = _useState10[0],\n    setActiveIndex = _useState10[1];\n  var _useState11 = useState(false),\n    _useState12 = _slicedToArray(_useState11, 2),\n    isFocus = _useState12[0],\n    setIsFocus = _useState12[1];\n\n  // ============================== Value ===============================\n  var _useMergedState = useMergedState('', {\n      defaultValue: defaultValue,\n      value: value\n    }),\n    _useMergedState2 = _slicedToArray(_useMergedState, 2),\n    mergedValue = _useMergedState2[0],\n    setMergedValue = _useMergedState2[1];\n\n  // =============================== Open ===============================\n  useEffect(function () {\n    // Sync measure div top with textarea for rc-trigger usage\n    if (measuring && measureRef.current) {\n      measureRef.current.scrollTop = getTextArea().scrollTop;\n    }\n  }, [measuring]);\n  var _React$useMemo = React.useMemo(function () {\n      if (open) {\n        if (process.env.NODE_ENV !== 'production') {\n          warning(false, '`open` of Mentions is only used for debug usage. Do not use in you production.');\n        }\n        for (var i = 0; i < mergedPrefix.length; i += 1) {\n          var curPrefix = mergedPrefix[i];\n          var index = mergedValue.lastIndexOf(curPrefix);\n          if (index >= 0) {\n            return [true, '', curPrefix, index];\n          }\n        }\n      }\n      return [measuring, measureText, measurePrefix, measureLocation];\n    }, [open, measuring, mergedPrefix, mergedValue, measureText, measurePrefix, measureLocation]),\n    _React$useMemo2 = _slicedToArray(_React$useMemo, 4),\n    mergedMeasuring = _React$useMemo2[0],\n    mergedMeasureText = _React$useMemo2[1],\n    mergedMeasurePrefix = _React$useMemo2[2],\n    mergedMeasureLocation = _React$useMemo2[3];\n\n  // ============================== Option ==============================\n  var getOptions = React.useCallback(function (targetMeasureText) {\n    var list;\n    if (options && options.length > 0) {\n      list = options.map(function (item) {\n        var _item$key;\n        return _objectSpread(_objectSpread({}, item), {}, {\n          key: (_item$key = item === null || item === void 0 ? void 0 : item.key) !== null && _item$key !== void 0 ? _item$key : item.value\n        });\n      });\n    } else {\n      list = toArray(children).map(function (_ref) {\n        var optionProps = _ref.props,\n          key = _ref.key;\n        return _objectSpread(_objectSpread({}, optionProps), {}, {\n          label: optionProps.children,\n          key: key || optionProps.value\n        });\n      });\n    }\n    return list.filter(function (option) {\n      /** Return all result if `filterOption` is false. */\n      if (filterOption === false) {\n        return true;\n      }\n      return filterOption(targetMeasureText, option);\n    });\n  }, [children, options, filterOption]);\n  var mergedOptions = React.useMemo(function () {\n    return getOptions(mergedMeasureText);\n  }, [getOptions, mergedMeasureText]);\n\n  // ============================= Measure ==============================\n  // Mark that we will reset input selection to target position when user select option\n  var onSelectionEffect = useEffectState();\n  var startMeasure = function startMeasure(nextMeasureText, nextMeasurePrefix, nextMeasureLocation) {\n    setMeasuring(true);\n    setMeasureText(nextMeasureText);\n    setMeasurePrefix(nextMeasurePrefix);\n    setMeasureLocation(nextMeasureLocation);\n    setActiveIndex(0);\n  };\n  var stopMeasure = function stopMeasure(callback) {\n    setMeasuring(false);\n    setMeasureLocation(0);\n    setMeasureText('');\n    onSelectionEffect(callback);\n  };\n\n  // ============================== Change ==============================\n  var triggerChange = function triggerChange(nextValue) {\n    setMergedValue(nextValue);\n    onChange === null || onChange === void 0 || onChange(nextValue);\n  };\n  var onInternalChange = function onInternalChange(_ref2) {\n    var nextValue = _ref2.target.value;\n    triggerChange(nextValue);\n  };\n  var selectOption = function selectOption(option) {\n    var _getTextArea;\n    var _option$value = option.value,\n      mentionValue = _option$value === void 0 ? '' : _option$value;\n    var _replaceWithMeasure = replaceWithMeasure(mergedValue, {\n        measureLocation: mergedMeasureLocation,\n        targetText: mentionValue,\n        prefix: mergedMeasurePrefix,\n        selectionStart: (_getTextArea = getTextArea()) === null || _getTextArea === void 0 ? void 0 : _getTextArea.selectionStart,\n        split: split\n      }),\n      text = _replaceWithMeasure.text,\n      selectionLocation = _replaceWithMeasure.selectionLocation;\n    triggerChange(text);\n    stopMeasure(function () {\n      // We need restore the selection position\n      setInputSelection(getTextArea(), selectionLocation);\n    });\n    onSelect === null || onSelect === void 0 || onSelect(option, mergedMeasurePrefix);\n  };\n\n  // ============================= KeyEvent =============================\n  // Check if hit the measure keyword\n  var onInternalKeyDown = function onInternalKeyDown(event) {\n    var which = event.which;\n    onKeyDown === null || onKeyDown === void 0 || onKeyDown(event);\n\n    // Skip if not measuring\n    if (!mergedMeasuring) {\n      return;\n    }\n    if (which === KeyCode.UP || which === KeyCode.DOWN) {\n      // Control arrow function\n      var optionLen = mergedOptions.length;\n      var offset = which === KeyCode.UP ? -1 : 1;\n      var newActiveIndex = (activeIndex + offset + optionLen) % optionLen;\n      setActiveIndex(newActiveIndex);\n      event.preventDefault();\n    } else if (which === KeyCode.ESC) {\n      stopMeasure();\n    } else if (which === KeyCode.ENTER) {\n      // Measure hit\n      event.preventDefault();\n      // loading skip\n      if (silent) {\n        return;\n      }\n      if (!mergedOptions.length) {\n        stopMeasure();\n        return;\n      }\n      var _option = mergedOptions[activeIndex];\n      selectOption(_option);\n    }\n  };\n\n  /**\n   * When to start measure:\n   * 1. When user press `prefix`\n   * 2. When measureText !== prevMeasureText\n   *  - If measure hit\n   *  - If measuring\n   *\n   * When to stop measure:\n   * 1. Selection is out of range\n   * 2. Contains `space`\n   * 3. ESC or select one\n   */\n  var onInternalKeyUp = function onInternalKeyUp(event) {\n    var key = event.key,\n      which = event.which;\n    var target = event.target;\n    var selectionStartText = getBeforeSelectionText(target);\n    var _getLastMeasureIndex = getLastMeasureIndex(selectionStartText, mergedPrefix),\n      measureIndex = _getLastMeasureIndex.location,\n      nextMeasurePrefix = _getLastMeasureIndex.prefix;\n\n    // If the client implements an onKeyUp handler, call it\n    onKeyUp === null || onKeyUp === void 0 || onKeyUp(event);\n\n    // Skip if match the white key list\n    if ([KeyCode.ESC, KeyCode.UP, KeyCode.DOWN, KeyCode.ENTER].indexOf(which) !== -1) {\n      return;\n    }\n    if (measureIndex !== -1) {\n      var nextMeasureText = selectionStartText.slice(measureIndex + nextMeasurePrefix.length);\n      var validateMeasure = validateSearch(nextMeasureText, split);\n      var matchOption = !!getOptions(nextMeasureText).length;\n      if (validateMeasure) {\n        // adding AltGraph also fort azert keyboard\n        if (key === nextMeasurePrefix || key === 'Shift' || which === KeyCode.ALT || key === 'AltGraph' || mergedMeasuring || nextMeasureText !== mergedMeasureText && matchOption) {\n          startMeasure(nextMeasureText, nextMeasurePrefix, measureIndex);\n        }\n      } else if (mergedMeasuring) {\n        // Stop if measureText is invalidate\n        stopMeasure();\n      }\n\n      /**\n       * We will trigger `onSearch` to developer since they may use for async update.\n       * If met `space` means user finished searching.\n       */\n      if (onSearch && validateMeasure) {\n        onSearch(nextMeasureText, nextMeasurePrefix);\n      }\n    } else if (mergedMeasuring) {\n      stopMeasure();\n    }\n  };\n  var onInternalPressEnter = function onInternalPressEnter(event) {\n    if (!mergedMeasuring && onPressEnter) {\n      onPressEnter(event);\n    }\n  };\n\n  // ============================ Focus Blur ============================\n  var focusRef = useRef();\n  var onInternalFocus = function onInternalFocus(event) {\n    window.clearTimeout(focusRef.current);\n    if (!isFocus && event && onFocus) {\n      onFocus(event);\n    }\n    setIsFocus(true);\n  };\n  var onInternalBlur = function onInternalBlur(event) {\n    focusRef.current = window.setTimeout(function () {\n      setIsFocus(false);\n      stopMeasure();\n      onBlur === null || onBlur === void 0 || onBlur(event);\n    }, 0);\n  };\n  var onDropdownFocus = function onDropdownFocus() {\n    onInternalFocus();\n  };\n  var onDropdownBlur = function onDropdownBlur() {\n    onInternalBlur();\n  };\n\n  // ============================== Scroll ===============================\n  var onInternalPopupScroll = function onInternalPopupScroll(event) {\n    onPopupScroll === null || onPopupScroll === void 0 || onPopupScroll(event);\n  };\n\n  // ============================== Render ==============================\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(prefixCls, className),\n    style: style,\n    ref: containerRef\n  }, /*#__PURE__*/React.createElement(TextArea, _extends({\n    ref: textareaRef,\n    value: mergedValue\n  }, restProps, {\n    rows: rows,\n    onChange: onInternalChange,\n    onKeyDown: onInternalKeyDown,\n    onKeyUp: onInternalKeyUp,\n    onPressEnter: onInternalPressEnter,\n    onFocus: onInternalFocus,\n    onBlur: onInternalBlur\n  })), mergedMeasuring && /*#__PURE__*/React.createElement(\"div\", {\n    ref: measureRef,\n    className: \"\".concat(prefixCls, \"-measure\")\n  }, mergedValue.slice(0, mergedMeasureLocation), /*#__PURE__*/React.createElement(MentionsContext.Provider, {\n    value: {\n      notFoundContent: notFoundContent,\n      activeIndex: activeIndex,\n      setActiveIndex: setActiveIndex,\n      selectOption: selectOption,\n      onFocus: onDropdownFocus,\n      onBlur: onDropdownBlur,\n      onScroll: onInternalPopupScroll\n    }\n  }, /*#__PURE__*/React.createElement(KeywordTrigger, {\n    prefixCls: prefixCls,\n    transitionName: transitionName,\n    placement: placement,\n    direction: direction,\n    options: mergedOptions,\n    visible: true,\n    getPopupContainer: getPopupContainer,\n    dropdownClassName: dropdownClassName\n  }, /*#__PURE__*/React.createElement(\"span\", null, mergedMeasurePrefix))), mergedValue.slice(mergedMeasureLocation + mergedMeasurePrefix.length)));\n});\nvar Mentions = /*#__PURE__*/forwardRef(function (_ref3, ref) {\n  var suffix = _ref3.suffix,\n    _ref3$prefixCls = _ref3.prefixCls,\n    prefixCls = _ref3$prefixCls === void 0 ? 'rc-mentions' : _ref3$prefixCls,\n    defaultValue = _ref3.defaultValue,\n    customValue = _ref3.value,\n    allowClear = _ref3.allowClear,\n    onChange = _ref3.onChange,\n    classes = _ref3.classNames,\n    className = _ref3.className,\n    disabled = _ref3.disabled,\n    onClear = _ref3.onClear,\n    rest = _objectWithoutProperties(_ref3, _excluded2);\n  // =============================== Ref ================================\n  var holderRef = useRef(null);\n  var mentionRef = useRef(null);\n  useImperativeHandle(ref, function () {\n    var _holderRef$current, _mentionRef$current;\n    return _objectSpread(_objectSpread({}, mentionRef.current), {}, {\n      nativeElement: ((_holderRef$current = holderRef.current) === null || _holderRef$current === void 0 ? void 0 : _holderRef$current.nativeElement) || ((_mentionRef$current = mentionRef.current) === null || _mentionRef$current === void 0 ? void 0 : _mentionRef$current.nativeElement)\n    });\n  });\n\n  // ============================== Value ===============================\n  var _useMergedState3 = useMergedState('', {\n      defaultValue: defaultValue,\n      value: customValue\n    }),\n    _useMergedState4 = _slicedToArray(_useMergedState3, 2),\n    mergedValue = _useMergedState4[0],\n    setMergedValue = _useMergedState4[1];\n\n  // ============================== Change ==============================\n  var triggerChange = function triggerChange(currentValue) {\n    setMergedValue(currentValue);\n    onChange === null || onChange === void 0 || onChange(currentValue);\n  };\n\n  // ============================== Reset ===============================\n  var handleReset = function handleReset() {\n    triggerChange('');\n  };\n  return /*#__PURE__*/React.createElement(BaseInput, {\n    suffix: suffix,\n    prefixCls: prefixCls,\n    value: mergedValue,\n    allowClear: allowClear,\n    handleReset: handleReset,\n    className: className,\n    classNames: classes,\n    disabled: disabled,\n    ref: holderRef,\n    onClear: onClear\n  }, /*#__PURE__*/React.createElement(InternalMentions, _extends({\n    className: classes === null || classes === void 0 ? void 0 : classes.mentions,\n    prefixCls: prefixCls,\n    ref: mentionRef,\n    onChange: triggerChange,\n    disabled: disabled\n  }, rest)));\n});\nMentions.Option = Option;\nexport default Mentions;"]},"metadata":{},"sourceType":"module"}