{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nvar _excluded = [\"disabled\", \"title\", \"children\", \"style\", \"className\"];\nimport classNames from 'classnames';\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport useMemo from \"rc-util/es/hooks/useMemo\";\nimport omit from \"rc-util/es/omit\";\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport List from 'rc-virtual-list';\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport SelectContext from \"./SelectContext\";\nimport TransBtn from \"./TransBtn\";\nimport useBaseProps from \"./hooks/useBaseProps\";\nimport { isPlatformMac } from \"./utils/platformUtil\";\nimport { isValidCount } from \"./utils/valueUtil\"; // export interface OptionListProps<OptionsType extends object[]> {\n\nfunction isTitleType(content) {\n  return typeof content === 'string' || typeof content === 'number';\n}\n/**\n * Using virtual list of option display.\n * Will fallback to dom if use customize render.\n */\n\n\nvar OptionList = function OptionList(_, ref) {\n  var _useBaseProps = useBaseProps(),\n      prefixCls = _useBaseProps.prefixCls,\n      id = _useBaseProps.id,\n      open = _useBaseProps.open,\n      multiple = _useBaseProps.multiple,\n      mode = _useBaseProps.mode,\n      searchValue = _useBaseProps.searchValue,\n      toggleOpen = _useBaseProps.toggleOpen,\n      notFoundContent = _useBaseProps.notFoundContent,\n      onPopupScroll = _useBaseProps.onPopupScroll;\n\n  var _React$useContext = React.useContext(SelectContext),\n      maxCount = _React$useContext.maxCount,\n      flattenOptions = _React$useContext.flattenOptions,\n      onActiveValue = _React$useContext.onActiveValue,\n      defaultActiveFirstOption = _React$useContext.defaultActiveFirstOption,\n      onSelect = _React$useContext.onSelect,\n      menuItemSelectedIcon = _React$useContext.menuItemSelectedIcon,\n      rawValues = _React$useContext.rawValues,\n      fieldNames = _React$useContext.fieldNames,\n      virtual = _React$useContext.virtual,\n      direction = _React$useContext.direction,\n      listHeight = _React$useContext.listHeight,\n      listItemHeight = _React$useContext.listItemHeight,\n      optionRender = _React$useContext.optionRender;\n\n  var itemPrefixCls = \"\".concat(prefixCls, \"-item\");\n  var memoFlattenOptions = useMemo(function () {\n    return flattenOptions;\n  }, [open, flattenOptions], function (prev, next) {\n    return next[0] && prev[1] !== next[1];\n  }); // =========================== List ===========================\n\n  var listRef = React.useRef(null);\n  var overMaxCount = React.useMemo(function () {\n    return multiple && isValidCount(maxCount) && (rawValues === null || rawValues === void 0 ? void 0 : rawValues.size) >= maxCount;\n  }, [multiple, maxCount, rawValues === null || rawValues === void 0 ? void 0 : rawValues.size]);\n\n  var onListMouseDown = function onListMouseDown(event) {\n    event.preventDefault();\n  };\n\n  var scrollIntoView = function scrollIntoView(args) {\n    var _listRef$current;\n\n    (_listRef$current = listRef.current) === null || _listRef$current === void 0 || _listRef$current.scrollTo(typeof args === 'number' ? {\n      index: args\n    } : args);\n  }; // https://github.com/ant-design/ant-design/issues/34975\n\n\n  var isSelected = React.useCallback(function (value) {\n    if (mode === 'combobox') {\n      return false;\n    }\n\n    return rawValues.has(value);\n  }, [mode, _toConsumableArray(rawValues).toString(), rawValues.size]); // ========================== Active ==========================\n\n  var getEnabledActiveIndex = function getEnabledActiveIndex(index) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    var len = memoFlattenOptions.length;\n\n    for (var i = 0; i < len; i += 1) {\n      var current = (index + i * offset + len) % len;\n\n      var _ref = memoFlattenOptions[current] || {},\n          group = _ref.group,\n          data = _ref.data;\n\n      if (!group && !(data !== null && data !== void 0 && data.disabled) && (isSelected(data.value) || !overMaxCount)) {\n        return current;\n      }\n    }\n\n    return -1;\n  };\n\n  var _React$useState = React.useState(function () {\n    return getEnabledActiveIndex(0);\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activeIndex = _React$useState2[0],\n      setActiveIndex = _React$useState2[1];\n\n  var setActive = function setActive(index) {\n    var fromKeyboard = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    setActiveIndex(index);\n    var info = {\n      source: fromKeyboard ? 'keyboard' : 'mouse'\n    }; // Trigger active event\n\n    var flattenItem = memoFlattenOptions[index];\n\n    if (!flattenItem) {\n      onActiveValue(null, -1, info);\n      return;\n    }\n\n    onActiveValue(flattenItem.value, index, info);\n  }; // Auto active first item when list length or searchValue changed\n\n\n  useEffect(function () {\n    setActive(defaultActiveFirstOption !== false ? getEnabledActiveIndex(0) : -1);\n  }, [memoFlattenOptions.length, searchValue]); // https://github.com/ant-design/ant-design/issues/48036\n\n  var isAriaSelected = React.useCallback(function (value) {\n    if (mode === 'combobox') {\n      return String(value).toLowerCase() === searchValue.toLowerCase();\n    }\n\n    return rawValues.has(value);\n  }, [mode, searchValue, _toConsumableArray(rawValues).toString(), rawValues.size]); // Auto scroll to item position in single mode\n\n  useEffect(function () {\n    /**\n     * React will skip `onChange` when component update.\n     * `setActive` function will call root accessibility state update which makes re-render.\n     * So we need to delay to let Input component trigger onChange first.\n     */\n    var timeoutId = setTimeout(function () {\n      if (!multiple && open && rawValues.size === 1) {\n        var value = Array.from(rawValues)[0];\n        var index = memoFlattenOptions.findIndex(function (_ref2) {\n          var data = _ref2.data;\n          return data.value === value;\n        });\n\n        if (index !== -1) {\n          setActive(index);\n          scrollIntoView(index);\n        }\n      }\n    }); // Force trigger scrollbar visible when open\n\n    if (open) {\n      var _listRef$current2;\n\n      (_listRef$current2 = listRef.current) === null || _listRef$current2 === void 0 || _listRef$current2.scrollTo(undefined);\n    }\n\n    return function () {\n      return clearTimeout(timeoutId);\n    };\n  }, [open, searchValue]); // ========================== Values ==========================\n\n  var onSelectValue = function onSelectValue(value) {\n    if (value !== undefined) {\n      onSelect(value, {\n        selected: !rawValues.has(value)\n      });\n    } // Single mode should always close by select\n\n\n    if (!multiple) {\n      toggleOpen(false);\n    }\n  }; // ========================= Keyboard =========================\n\n\n  React.useImperativeHandle(ref, function () {\n    return {\n      onKeyDown: function onKeyDown(event) {\n        var which = event.which,\n            ctrlKey = event.ctrlKey;\n\n        switch (which) {\n          // >>> Arrow keys & ctrl + n/p on Mac\n          case KeyCode.N:\n          case KeyCode.P:\n          case KeyCode.UP:\n          case KeyCode.DOWN:\n            {\n              var offset = 0;\n\n              if (which === KeyCode.UP) {\n                offset = -1;\n              } else if (which === KeyCode.DOWN) {\n                offset = 1;\n              } else if (isPlatformMac() && ctrlKey) {\n                if (which === KeyCode.N) {\n                  offset = 1;\n                } else if (which === KeyCode.P) {\n                  offset = -1;\n                }\n              }\n\n              if (offset !== 0) {\n                var nextActiveIndex = getEnabledActiveIndex(activeIndex + offset, offset);\n                scrollIntoView(nextActiveIndex);\n                setActive(nextActiveIndex, true);\n              }\n\n              break;\n            }\n          // >>> Select (Tab / Enter)\n\n          case KeyCode.TAB:\n          case KeyCode.ENTER:\n            {\n              var _item$data; // value\n\n\n              var item = memoFlattenOptions[activeIndex];\n\n              if (item && !(item !== null && item !== void 0 && (_item$data = item.data) !== null && _item$data !== void 0 && _item$data.disabled) && !overMaxCount) {\n                onSelectValue(item.value);\n              } else {\n                onSelectValue(undefined);\n              }\n\n              if (open) {\n                event.preventDefault();\n              }\n\n              break;\n            }\n          // >>> Close\n\n          case KeyCode.ESC:\n            {\n              toggleOpen(false);\n\n              if (open) {\n                event.stopPropagation();\n              }\n            }\n        }\n      },\n      onKeyUp: function onKeyUp() {},\n      scrollTo: function scrollTo(index) {\n        scrollIntoView(index);\n      }\n    };\n  }); // ========================== Render ==========================\n\n  if (memoFlattenOptions.length === 0) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      role: \"listbox\",\n      id: \"\".concat(id, \"_list\"),\n      className: \"\".concat(itemPrefixCls, \"-empty\"),\n      onMouseDown: onListMouseDown\n    }, notFoundContent);\n  }\n\n  var omitFieldNameList = Object.keys(fieldNames).map(function (key) {\n    return fieldNames[key];\n  });\n\n  var getLabel = function getLabel(item) {\n    return item.label;\n  };\n\n  function getItemAriaProps(item, index) {\n    var group = item.group;\n    return {\n      role: group ? 'presentation' : 'option',\n      id: \"\".concat(id, \"_list_\").concat(index)\n    };\n  }\n\n  var renderItem = function renderItem(index) {\n    var item = memoFlattenOptions[index];\n\n    if (!item) {\n      return null;\n    }\n\n    var itemData = item.data || {};\n    var value = itemData.value;\n    var group = item.group;\n    var attrs = pickAttrs(itemData, true);\n    var mergedLabel = getLabel(item);\n    return item ? /*#__PURE__*/React.createElement(\"div\", _extends({\n      \"aria-label\": typeof mergedLabel === 'string' && !group ? mergedLabel : null\n    }, attrs, {\n      key: index\n    }, getItemAriaProps(item, index), {\n      \"aria-selected\": isAriaSelected(value)\n    }), value) : null;\n  };\n\n  var a11yProps = {\n    role: 'listbox',\n    id: \"\".concat(id, \"_list\")\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, virtual && /*#__PURE__*/React.createElement(\"div\", _extends({}, a11yProps, {\n    style: {\n      height: 0,\n      width: 0,\n      overflow: 'hidden'\n    }\n  }), renderItem(activeIndex - 1), renderItem(activeIndex), renderItem(activeIndex + 1)), /*#__PURE__*/React.createElement(List, {\n    itemKey: \"key\",\n    ref: listRef,\n    data: memoFlattenOptions,\n    height: listHeight,\n    itemHeight: listItemHeight,\n    fullHeight: false,\n    onMouseDown: onListMouseDown,\n    onScroll: onPopupScroll,\n    virtual: virtual,\n    direction: direction,\n    innerProps: virtual ? null : a11yProps\n  }, function (item, itemIndex) {\n    var group = item.group,\n        groupOption = item.groupOption,\n        data = item.data,\n        label = item.label,\n        value = item.value;\n    var key = data.key; // Group\n\n    if (group) {\n      var _data$title;\n\n      var groupTitle = (_data$title = data.title) !== null && _data$title !== void 0 ? _data$title : isTitleType(label) ? label.toString() : undefined;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(itemPrefixCls, \"\".concat(itemPrefixCls, \"-group\"), data.className),\n        title: groupTitle\n      }, label !== undefined ? label : key);\n    }\n\n    var disabled = data.disabled,\n        title = data.title,\n        children = data.children,\n        style = data.style,\n        className = data.className,\n        otherProps = _objectWithoutProperties(data, _excluded);\n\n    var passedProps = omit(otherProps, omitFieldNameList); // Option\n\n    var selected = isSelected(value);\n    var mergedDisabled = disabled || !selected && overMaxCount;\n    var optionPrefixCls = \"\".concat(itemPrefixCls, \"-option\");\n    var optionClassName = classNames(itemPrefixCls, optionPrefixCls, className, _defineProperty(_defineProperty(_defineProperty(_defineProperty({}, \"\".concat(optionPrefixCls, \"-grouped\"), groupOption), \"\".concat(optionPrefixCls, \"-active\"), activeIndex === itemIndex && !mergedDisabled), \"\".concat(optionPrefixCls, \"-disabled\"), mergedDisabled), \"\".concat(optionPrefixCls, \"-selected\"), selected));\n    var mergedLabel = getLabel(item);\n    var iconVisible = !menuItemSelectedIcon || typeof menuItemSelectedIcon === 'function' || selected; // https://github.com/ant-design/ant-design/issues/34145\n\n    var content = typeof mergedLabel === 'number' ? mergedLabel : mergedLabel || value; // https://github.com/ant-design/ant-design/issues/26717\n\n    var optionTitle = isTitleType(content) ? content.toString() : undefined;\n\n    if (title !== undefined) {\n      optionTitle = title;\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", _extends({}, pickAttrs(passedProps), !virtual ? getItemAriaProps(item, itemIndex) : {}, {\n      \"aria-selected\": isAriaSelected(value),\n      className: optionClassName,\n      title: optionTitle,\n      onMouseMove: function onMouseMove() {\n        if (activeIndex === itemIndex || mergedDisabled) {\n          return;\n        }\n\n        setActive(itemIndex);\n      },\n      onClick: function onClick() {\n        if (!mergedDisabled) {\n          onSelectValue(value);\n        }\n      },\n      style: style\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(optionPrefixCls, \"-content\")\n    }, typeof optionRender === 'function' ? optionRender(item, {\n      index: itemIndex\n    }) : content), /*#__PURE__*/React.isValidElement(menuItemSelectedIcon) || selected, iconVisible && /*#__PURE__*/React.createElement(TransBtn, {\n      className: \"\".concat(itemPrefixCls, \"-option-state\"),\n      customizeIcon: menuItemSelectedIcon,\n      customizeIconProps: {\n        value: value,\n        disabled: mergedDisabled,\n        isSelected: selected\n      }\n    }, selected ? '✓' : null));\n  }));\n};\n\nvar RefOptionList = /*#__PURE__*/React.forwardRef(OptionList);\n\nif (process.env.NODE_ENV !== 'production') {\n  RefOptionList.displayName = 'OptionList';\n}\n\nexport default RefOptionList;","map":{"version":3,"sources":["/Users/malith_bandara/Desktop/AdminDashboard/node_modules/rc-select/es/OptionList.js"],"names":["_defineProperty","_objectWithoutProperties","_extends","_slicedToArray","_toConsumableArray","_excluded","classNames","KeyCode","useMemo","omit","pickAttrs","List","React","useEffect","SelectContext","TransBtn","useBaseProps","isPlatformMac","isValidCount","isTitleType","content","OptionList","_","ref","_useBaseProps","prefixCls","id","open","multiple","mode","searchValue","toggleOpen","notFoundContent","onPopupScroll","_React$useContext","useContext","maxCount","flattenOptions","onActiveValue","defaultActiveFirstOption","onSelect","menuItemSelectedIcon","rawValues","fieldNames","virtual","direction","listHeight","listItemHeight","optionRender","itemPrefixCls","concat","memoFlattenOptions","prev","next","listRef","useRef","overMaxCount","size","onListMouseDown","event","preventDefault","scrollIntoView","args","_listRef$current","current","scrollTo","index","isSelected","useCallback","value","has","toString","getEnabledActiveIndex","offset","arguments","length","undefined","len","i","_ref","group","data","disabled","_React$useState","useState","_React$useState2","activeIndex","setActiveIndex","setActive","fromKeyboard","info","source","flattenItem","isAriaSelected","String","toLowerCase","timeoutId","setTimeout","Array","from","findIndex","_ref2","_listRef$current2","clearTimeout","onSelectValue","selected","useImperativeHandle","onKeyDown","which","ctrlKey","N","P","UP","DOWN","nextActiveIndex","TAB","ENTER","_item$data","item","ESC","stopPropagation","onKeyUp","createElement","role","className","onMouseDown","omitFieldNameList","Object","keys","map","key","getLabel","label","getItemAriaProps","renderItem","itemData","attrs","mergedLabel","a11yProps","Fragment","style","height","width","overflow","itemKey","itemHeight","fullHeight","onScroll","innerProps","itemIndex","groupOption","_data$title","groupTitle","title","children","otherProps","passedProps","mergedDisabled","optionPrefixCls","optionClassName","iconVisible","optionTitle","onMouseMove","onClick","isValidElement","customizeIcon","customizeIconProps","RefOptionList","forwardRef","process","env","NODE_ENV","displayName"],"mappings":"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","sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nvar _excluded = [\"disabled\", \"title\", \"children\", \"style\", \"className\"];\nimport classNames from 'classnames';\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport useMemo from \"rc-util/es/hooks/useMemo\";\nimport omit from \"rc-util/es/omit\";\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport List from 'rc-virtual-list';\nimport * as React from 'react';\nimport { useEffect } from 'react';\nimport SelectContext from \"./SelectContext\";\nimport TransBtn from \"./TransBtn\";\nimport useBaseProps from \"./hooks/useBaseProps\";\nimport { isPlatformMac } from \"./utils/platformUtil\";\nimport { isValidCount } from \"./utils/valueUtil\";\n\n// export interface OptionListProps<OptionsType extends object[]> {\n\nfunction isTitleType(content) {\n  return typeof content === 'string' || typeof content === 'number';\n}\n\n/**\n * Using virtual list of option display.\n * Will fallback to dom if use customize render.\n */\nvar OptionList = function OptionList(_, ref) {\n  var _useBaseProps = useBaseProps(),\n    prefixCls = _useBaseProps.prefixCls,\n    id = _useBaseProps.id,\n    open = _useBaseProps.open,\n    multiple = _useBaseProps.multiple,\n    mode = _useBaseProps.mode,\n    searchValue = _useBaseProps.searchValue,\n    toggleOpen = _useBaseProps.toggleOpen,\n    notFoundContent = _useBaseProps.notFoundContent,\n    onPopupScroll = _useBaseProps.onPopupScroll;\n  var _React$useContext = React.useContext(SelectContext),\n    maxCount = _React$useContext.maxCount,\n    flattenOptions = _React$useContext.flattenOptions,\n    onActiveValue = _React$useContext.onActiveValue,\n    defaultActiveFirstOption = _React$useContext.defaultActiveFirstOption,\n    onSelect = _React$useContext.onSelect,\n    menuItemSelectedIcon = _React$useContext.menuItemSelectedIcon,\n    rawValues = _React$useContext.rawValues,\n    fieldNames = _React$useContext.fieldNames,\n    virtual = _React$useContext.virtual,\n    direction = _React$useContext.direction,\n    listHeight = _React$useContext.listHeight,\n    listItemHeight = _React$useContext.listItemHeight,\n    optionRender = _React$useContext.optionRender;\n  var itemPrefixCls = \"\".concat(prefixCls, \"-item\");\n  var memoFlattenOptions = useMemo(function () {\n    return flattenOptions;\n  }, [open, flattenOptions], function (prev, next) {\n    return next[0] && prev[1] !== next[1];\n  });\n\n  // =========================== List ===========================\n  var listRef = React.useRef(null);\n  var overMaxCount = React.useMemo(function () {\n    return multiple && isValidCount(maxCount) && (rawValues === null || rawValues === void 0 ? void 0 : rawValues.size) >= maxCount;\n  }, [multiple, maxCount, rawValues === null || rawValues === void 0 ? void 0 : rawValues.size]);\n  var onListMouseDown = function onListMouseDown(event) {\n    event.preventDefault();\n  };\n  var scrollIntoView = function scrollIntoView(args) {\n    var _listRef$current;\n    (_listRef$current = listRef.current) === null || _listRef$current === void 0 || _listRef$current.scrollTo(typeof args === 'number' ? {\n      index: args\n    } : args);\n  };\n\n  // https://github.com/ant-design/ant-design/issues/34975\n  var isSelected = React.useCallback(function (value) {\n    if (mode === 'combobox') {\n      return false;\n    }\n    return rawValues.has(value);\n  }, [mode, _toConsumableArray(rawValues).toString(), rawValues.size]);\n\n  // ========================== Active ==========================\n  var getEnabledActiveIndex = function getEnabledActiveIndex(index) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    var len = memoFlattenOptions.length;\n    for (var i = 0; i < len; i += 1) {\n      var current = (index + i * offset + len) % len;\n      var _ref = memoFlattenOptions[current] || {},\n        group = _ref.group,\n        data = _ref.data;\n      if (!group && !(data !== null && data !== void 0 && data.disabled) && (isSelected(data.value) || !overMaxCount)) {\n        return current;\n      }\n    }\n    return -1;\n  };\n  var _React$useState = React.useState(function () {\n      return getEnabledActiveIndex(0);\n    }),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    activeIndex = _React$useState2[0],\n    setActiveIndex = _React$useState2[1];\n  var setActive = function setActive(index) {\n    var fromKeyboard = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    setActiveIndex(index);\n    var info = {\n      source: fromKeyboard ? 'keyboard' : 'mouse'\n    };\n\n    // Trigger active event\n    var flattenItem = memoFlattenOptions[index];\n    if (!flattenItem) {\n      onActiveValue(null, -1, info);\n      return;\n    }\n    onActiveValue(flattenItem.value, index, info);\n  };\n\n  // Auto active first item when list length or searchValue changed\n  useEffect(function () {\n    setActive(defaultActiveFirstOption !== false ? getEnabledActiveIndex(0) : -1);\n  }, [memoFlattenOptions.length, searchValue]);\n\n  // https://github.com/ant-design/ant-design/issues/48036\n  var isAriaSelected = React.useCallback(function (value) {\n    if (mode === 'combobox') {\n      return String(value).toLowerCase() === searchValue.toLowerCase();\n    }\n    return rawValues.has(value);\n  }, [mode, searchValue, _toConsumableArray(rawValues).toString(), rawValues.size]);\n\n  // Auto scroll to item position in single mode\n  useEffect(function () {\n    /**\n     * React will skip `onChange` when component update.\n     * `setActive` function will call root accessibility state update which makes re-render.\n     * So we need to delay to let Input component trigger onChange first.\n     */\n    var timeoutId = setTimeout(function () {\n      if (!multiple && open && rawValues.size === 1) {\n        var value = Array.from(rawValues)[0];\n        var index = memoFlattenOptions.findIndex(function (_ref2) {\n          var data = _ref2.data;\n          return data.value === value;\n        });\n        if (index !== -1) {\n          setActive(index);\n          scrollIntoView(index);\n        }\n      }\n    });\n\n    // Force trigger scrollbar visible when open\n    if (open) {\n      var _listRef$current2;\n      (_listRef$current2 = listRef.current) === null || _listRef$current2 === void 0 || _listRef$current2.scrollTo(undefined);\n    }\n    return function () {\n      return clearTimeout(timeoutId);\n    };\n  }, [open, searchValue]);\n\n  // ========================== Values ==========================\n  var onSelectValue = function onSelectValue(value) {\n    if (value !== undefined) {\n      onSelect(value, {\n        selected: !rawValues.has(value)\n      });\n    }\n\n    // Single mode should always close by select\n    if (!multiple) {\n      toggleOpen(false);\n    }\n  };\n\n  // ========================= Keyboard =========================\n  React.useImperativeHandle(ref, function () {\n    return {\n      onKeyDown: function onKeyDown(event) {\n        var which = event.which,\n          ctrlKey = event.ctrlKey;\n        switch (which) {\n          // >>> Arrow keys & ctrl + n/p on Mac\n          case KeyCode.N:\n          case KeyCode.P:\n          case KeyCode.UP:\n          case KeyCode.DOWN:\n            {\n              var offset = 0;\n              if (which === KeyCode.UP) {\n                offset = -1;\n              } else if (which === KeyCode.DOWN) {\n                offset = 1;\n              } else if (isPlatformMac() && ctrlKey) {\n                if (which === KeyCode.N) {\n                  offset = 1;\n                } else if (which === KeyCode.P) {\n                  offset = -1;\n                }\n              }\n              if (offset !== 0) {\n                var nextActiveIndex = getEnabledActiveIndex(activeIndex + offset, offset);\n                scrollIntoView(nextActiveIndex);\n                setActive(nextActiveIndex, true);\n              }\n              break;\n            }\n\n          // >>> Select (Tab / Enter)\n          case KeyCode.TAB:\n          case KeyCode.ENTER:\n            {\n              var _item$data;\n              // value\n              var item = memoFlattenOptions[activeIndex];\n              if (item && !(item !== null && item !== void 0 && (_item$data = item.data) !== null && _item$data !== void 0 && _item$data.disabled) && !overMaxCount) {\n                onSelectValue(item.value);\n              } else {\n                onSelectValue(undefined);\n              }\n              if (open) {\n                event.preventDefault();\n              }\n              break;\n            }\n\n          // >>> Close\n          case KeyCode.ESC:\n            {\n              toggleOpen(false);\n              if (open) {\n                event.stopPropagation();\n              }\n            }\n        }\n      },\n      onKeyUp: function onKeyUp() {},\n      scrollTo: function scrollTo(index) {\n        scrollIntoView(index);\n      }\n    };\n  });\n\n  // ========================== Render ==========================\n  if (memoFlattenOptions.length === 0) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      role: \"listbox\",\n      id: \"\".concat(id, \"_list\"),\n      className: \"\".concat(itemPrefixCls, \"-empty\"),\n      onMouseDown: onListMouseDown\n    }, notFoundContent);\n  }\n  var omitFieldNameList = Object.keys(fieldNames).map(function (key) {\n    return fieldNames[key];\n  });\n  var getLabel = function getLabel(item) {\n    return item.label;\n  };\n  function getItemAriaProps(item, index) {\n    var group = item.group;\n    return {\n      role: group ? 'presentation' : 'option',\n      id: \"\".concat(id, \"_list_\").concat(index)\n    };\n  }\n  var renderItem = function renderItem(index) {\n    var item = memoFlattenOptions[index];\n    if (!item) {\n      return null;\n    }\n    var itemData = item.data || {};\n    var value = itemData.value;\n    var group = item.group;\n    var attrs = pickAttrs(itemData, true);\n    var mergedLabel = getLabel(item);\n    return item ? /*#__PURE__*/React.createElement(\"div\", _extends({\n      \"aria-label\": typeof mergedLabel === 'string' && !group ? mergedLabel : null\n    }, attrs, {\n      key: index\n    }, getItemAriaProps(item, index), {\n      \"aria-selected\": isAriaSelected(value)\n    }), value) : null;\n  };\n  var a11yProps = {\n    role: 'listbox',\n    id: \"\".concat(id, \"_list\")\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, virtual && /*#__PURE__*/React.createElement(\"div\", _extends({}, a11yProps, {\n    style: {\n      height: 0,\n      width: 0,\n      overflow: 'hidden'\n    }\n  }), renderItem(activeIndex - 1), renderItem(activeIndex), renderItem(activeIndex + 1)), /*#__PURE__*/React.createElement(List, {\n    itemKey: \"key\",\n    ref: listRef,\n    data: memoFlattenOptions,\n    height: listHeight,\n    itemHeight: listItemHeight,\n    fullHeight: false,\n    onMouseDown: onListMouseDown,\n    onScroll: onPopupScroll,\n    virtual: virtual,\n    direction: direction,\n    innerProps: virtual ? null : a11yProps\n  }, function (item, itemIndex) {\n    var group = item.group,\n      groupOption = item.groupOption,\n      data = item.data,\n      label = item.label,\n      value = item.value;\n    var key = data.key;\n\n    // Group\n    if (group) {\n      var _data$title;\n      var groupTitle = (_data$title = data.title) !== null && _data$title !== void 0 ? _data$title : isTitleType(label) ? label.toString() : undefined;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(itemPrefixCls, \"\".concat(itemPrefixCls, \"-group\"), data.className),\n        title: groupTitle\n      }, label !== undefined ? label : key);\n    }\n    var disabled = data.disabled,\n      title = data.title,\n      children = data.children,\n      style = data.style,\n      className = data.className,\n      otherProps = _objectWithoutProperties(data, _excluded);\n    var passedProps = omit(otherProps, omitFieldNameList);\n\n    // Option\n    var selected = isSelected(value);\n    var mergedDisabled = disabled || !selected && overMaxCount;\n    var optionPrefixCls = \"\".concat(itemPrefixCls, \"-option\");\n    var optionClassName = classNames(itemPrefixCls, optionPrefixCls, className, _defineProperty(_defineProperty(_defineProperty(_defineProperty({}, \"\".concat(optionPrefixCls, \"-grouped\"), groupOption), \"\".concat(optionPrefixCls, \"-active\"), activeIndex === itemIndex && !mergedDisabled), \"\".concat(optionPrefixCls, \"-disabled\"), mergedDisabled), \"\".concat(optionPrefixCls, \"-selected\"), selected));\n    var mergedLabel = getLabel(item);\n    var iconVisible = !menuItemSelectedIcon || typeof menuItemSelectedIcon === 'function' || selected;\n\n    // https://github.com/ant-design/ant-design/issues/34145\n    var content = typeof mergedLabel === 'number' ? mergedLabel : mergedLabel || value;\n    // https://github.com/ant-design/ant-design/issues/26717\n    var optionTitle = isTitleType(content) ? content.toString() : undefined;\n    if (title !== undefined) {\n      optionTitle = title;\n    }\n    return /*#__PURE__*/React.createElement(\"div\", _extends({}, pickAttrs(passedProps), !virtual ? getItemAriaProps(item, itemIndex) : {}, {\n      \"aria-selected\": isAriaSelected(value),\n      className: optionClassName,\n      title: optionTitle,\n      onMouseMove: function onMouseMove() {\n        if (activeIndex === itemIndex || mergedDisabled) {\n          return;\n        }\n        setActive(itemIndex);\n      },\n      onClick: function onClick() {\n        if (!mergedDisabled) {\n          onSelectValue(value);\n        }\n      },\n      style: style\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(optionPrefixCls, \"-content\")\n    }, typeof optionRender === 'function' ? optionRender(item, {\n      index: itemIndex\n    }) : content), /*#__PURE__*/React.isValidElement(menuItemSelectedIcon) || selected, iconVisible && /*#__PURE__*/React.createElement(TransBtn, {\n      className: \"\".concat(itemPrefixCls, \"-option-state\"),\n      customizeIcon: menuItemSelectedIcon,\n      customizeIconProps: {\n        value: value,\n        disabled: mergedDisabled,\n        isSelected: selected\n      }\n    }, selected ? '✓' : null));\n  }));\n};\nvar RefOptionList = /*#__PURE__*/React.forwardRef(OptionList);\nif (process.env.NODE_ENV !== 'production') {\n  RefOptionList.displayName = 'OptionList';\n}\nexport default RefOptionList;"]},"metadata":{},"sourceType":"module"}